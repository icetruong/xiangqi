@import url('https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&family=Noto+Sans+SC:wght@400;700&display=swap');

/* ─────────────── Design Tokens ─────────────── */
:root {
    /* Page */
    --bg-color: #1e0e08;
    --bg-color-light: #3a1e10;
    --text-color: #f0f0f0;

    /* Board Frame */
    --shell-bg: #c4a06a;
    --shell-bg-dark: #a0834e;
    --shell-border: #d4ba8a;
    --shell-border-inner: #6b4226;
    --shell-radius: 18px;

    /* Board Surface */
    --surface-bg: #f0dca0;
    --surface-bg-light: #f7eac0;
    --surface-bg-warm: #e6c87a;
    --surface-border: #7a5230;
    --surface-radius: 10px;

    /* Board Grid Area */
    --board-bg: #e8c88a;
    --board-bg-light: #f0dca8;
    --board-frame: #c4a060;
    --board-frame-dark: #8b6530;
    --grid-stroke: #8b6c42;

    /* Pieces */
    --piece-red-outer: #b5372a;
    --piece-red-inner: #d04a3a;
    --piece-red-highlight: #e86050;
    --piece-black-outer: #2c2c2c;
    --piece-black-inner: #4a4a4a;
    --piece-black-highlight: #666;
    --piece-rim: #f5e6c8;
    --piece-size-ratio: 0.82;

    /* Interaction */
    --highlight-gold: #f0b429;
    --hint-orange: #e67e22;
    --accent-gold: #ffd700;
    --accent-orange: #d4862b;
}

/* ─────────────── Base / Page ─────────────── */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Noto Sans SC', sans-serif;
    background:
        /* vignette overlay on page */
        radial-gradient(ellipse 75% 75% at 50% 50%,
            transparent 30%,
            rgba(0, 0, 0, 0.7) 100%),
        /* warm wood gradient */
        radial-gradient(ellipse at 50% 40%,
            var(--bg-color-light) 0%,
            var(--bg-color) 70%);
    color: var(--text-color);
    margin: 0;
    min-height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
}

/* ─────────────── Layout ─────────────── */
.main-container {
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 16px;
    width: 100%;
    height: 100vh;
}

.game-area {
    display: flex;
    justify-content: center;
    align-items: center;
    width: 100%;
    height: 100%;
}

/* ═══════════════════════════════════════════════
   Board Shell — Outer Frame (Layer 1)
   ═══════════════════════════════════════════════ */
.board-shell {
    /* Outer wooden frame with rounded corners */
    padding: 18px;
    background:
        /* subtle wood grain texture */
        repeating-linear-gradient(95deg,
            rgba(0, 0, 0, 0.05) 0px,
            rgba(0, 0, 0, 0.05) 1px,
            transparent 1px,
            transparent 6px),
        repeating-linear-gradient(0deg,
            rgba(0, 0, 0, 0.02) 0px,
            rgba(0, 0, 0, 0.02) 1px,
            transparent 1px,
            transparent 12px),
        /* main gradient — warm golden-brown */
        linear-gradient(160deg,
            #d6be90 0%,
            var(--shell-bg) 35%,
            var(--shell-bg-dark) 100%);
    border-radius: var(--shell-radius);
    /* thick outer border — light cream-brown */
    border: 3.5px solid var(--shell-border);
    /* shadows for depth */
    box-shadow:
        /* main outer drop shadow */
        0 16px 50px rgba(0, 0, 0, 0.6),
        0 6px 16px rgba(0, 0, 0, 0.35),
        /* outer rim highlight */
        0 -1px 0 rgba(255, 255, 255, 0.12),
        /* top edge gloss */
        inset 0 2px 0 rgba(255, 255, 255, 0.2),
        /* bottom inner shadow */
        inset 0 -3px 8px rgba(0, 0, 0, 0.15);

    /* Responsive sizing — max width, aspect-ratio based */
    max-width: min(520px, 93vw);
    width: 93vw;
}

/* ═══════════════════════════════════════════════
   Board Surface — Inner Mat (Layer 2)
   ═══════════════════════════════════════════════ */
.board-surface {
    /* Inner surface sits inside the shell with padding */
    padding: 14px;
    background:
        /* warm paper gradient — lighter on top, slightly darker at bottom */
        linear-gradient(180deg,
            var(--surface-bg-light) 0%,
            var(--surface-bg) 40%,
            var(--surface-bg-warm) 100%);
    border-radius: var(--surface-radius);
    /* thin dark brown border */
    border: 2px solid var(--surface-border);
    /* inner shadow for recessed feel */
    box-shadow:
        inset 0 3px 10px rgba(0, 0, 0, 0.18),
        inset 0 -2px 6px rgba(0, 0, 0, 0.08),
        inset 3px 0 8px rgba(0, 0, 0, 0.06),
        inset -3px 0 8px rgba(0, 0, 0, 0.06);
    position: relative;
}

/* Vignette overlay on the surface */
.board-surface::after {
    content: "";
    position: absolute;
    inset: 0;
    border-radius: var(--surface-radius);
    background: radial-gradient(ellipse 85% 85% at 50% 48%,
            transparent 50%,
            rgba(90, 60, 20, 0.15) 100%);
    pointer-events: none;
    z-index: 0;
}

/* ─────────────── Board Inner (Grid Area) ─────────────── */
.board-inner {
    position: relative;
    background:
        /* very subtle texture lines */
        repeating-linear-gradient(90deg,
            rgba(0, 0, 0, 0.015) 0px,
            rgba(0, 0, 0, 0.015) 1px,
            transparent 1px,
            transparent 5px),
        repeating-linear-gradient(0deg,
            rgba(0, 0, 0, 0.008) 0px,
            rgba(0, 0, 0, 0.008) 1px,
            transparent 1px,
            transparent 9px),
        /* warm paper base */
        linear-gradient(180deg,
            var(--board-bg-light) 0%,
            var(--board-bg) 50%,
            var(--board-bg-light) 100%);

    /* Dimensions set by JS via CSS custom properties */
    overflow: visible;
    user-select: none;
    -webkit-user-select: none;
    cursor: default;
    z-index: 1;
}

/* ─────────────── SVG Grid Overlay ─────────────── */
.board-svg {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 1;
}

/* ─────────────── Pieces ─────────────── */
.piece {
    position: absolute;
    z-index: 5;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    user-select: none;
    -webkit-user-select: none;

    /* Double-ring coin effect via box-shadow */
    transition:
        transform 0.18s cubic-bezier(.25, .8, .25, 1),
        box-shadow 0.18s cubic-bezier(.25, .8, .25, 1),
        filter 0.18s ease;
}

/* ─── Slide Animation ─── */
.piece--sliding {
    transition: transform 0.45s cubic-bezier(0.33, 1, 0.68, 1) !important;
    z-index: 50 !important;
    pointer-events: none !important;
}

/* ─── Captured Piece Fade-Out ─── */
.piece--captured {
    animation: fadeOutPiece 0.15s ease-out forwards;
    pointer-events: none !important;
}

@keyframes fadeOutPiece {
    to {
        opacity: 0;
        transform: scale(0.6);
    }
}

/* ─── Board Animating Lock ─── */
.board--animating {
    pointer-events: none !important;
}

/* Red pieces */
.piece-red {
    background: radial-gradient(circle at 38% 32%,
            var(--piece-red-highlight) 0%,
            var(--piece-red-inner) 40%,
            var(--piece-red-outer) 100%);
    box-shadow:
        /* outer colored ring */
        0 0 0 3px var(--piece-red-outer),
        /* cream inner ring */
        0 0 0 5px var(--piece-rim),
        /* outer border */
        0 0 0 6px #8b1a1a,
        /* drop shadow */
        0 4px 10px rgba(0, 0, 0, 0.4),
        /* inner gloss */
        inset 0 2px 4px rgba(255, 255, 255, 0.25),
        inset 0 -2px 4px rgba(0, 0, 0, 0.15);
    color: #fff;
    text-shadow:
        0 1px 2px rgba(0, 0, 0, 0.5),
        0 0 8px rgba(255, 200, 200, 0.3);
}

/* Black pieces */
.piece-black {
    background: radial-gradient(circle at 38% 32%,
            var(--piece-black-highlight) 0%,
            var(--piece-black-inner) 40%,
            var(--piece-black-outer) 100%);
    box-shadow:
        /* outer colored ring */
        0 0 0 3px var(--piece-black-outer),
        /* cream inner ring */
        0 0 0 5px var(--piece-rim),
        /* outer border */
        0 0 0 6px #111,
        /* drop shadow */
        0 4px 10px rgba(0, 0, 0, 0.5),
        /* inner gloss */
        inset 0 2px 4px rgba(255, 255, 255, 0.15),
        inset 0 -2px 4px rgba(0, 0, 0, 0.2);
    color: #e8e0d0;
    text-shadow:
        0 1px 2px rgba(0, 0, 0, 0.6),
        0 0 6px rgba(200, 200, 200, 0.2);
}

/* Piece text (Chinese character) */
.piece-text {
    font-family: 'Ma Shan Zheng', 'KaiTi', 'SimKai', 'STKaiti', serif;
    font-weight: bold;
    line-height: 1;
    pointer-events: none;
}

/* ─── Piece Hover ─── */
.piece:hover {
    transform: translateY(-2px);
    filter: brightness(1.08);
    z-index: 10;
}

.piece-red:hover {
    box-shadow:
        0 0 0 3px var(--piece-red-outer),
        0 0 0 5px var(--piece-rim),
        0 0 0 6px #8b1a1a,
        0 6px 16px rgba(0, 0, 0, 0.5),
        inset 0 2px 4px rgba(255, 255, 255, 0.25),
        inset 0 -2px 4px rgba(0, 0, 0, 0.15);
}

.piece-black:hover {
    box-shadow:
        0 0 0 3px var(--piece-black-outer),
        0 0 0 5px var(--piece-rim),
        0 0 0 6px #111,
        0 6px 16px rgba(0, 0, 0, 0.6),
        inset 0 2px 4px rgba(255, 255, 255, 0.15),
        inset 0 -2px 4px rgba(0, 0, 0, 0.2);
}

/* ─── Piece Selected ─── */
.piece.selected {
    transform: translateY(-2px);
    filter: brightness(1.1);
    z-index: 20;
}

.piece-red.selected {
    box-shadow:
        0 0 0 3px var(--piece-red-outer),
        0 0 0 5px var(--piece-rim),
        0 0 0 6px #8b1a1a,
        /* Golden glow ring */
        0 0 0 9px var(--highlight-gold),
        0 0 18px rgba(240, 180, 41, 0.5),
        0 6px 16px rgba(0, 0, 0, 0.4),
        inset 0 2px 4px rgba(255, 255, 255, 0.25),
        inset 0 -2px 4px rgba(0, 0, 0, 0.15);
}

.piece-black.selected {
    box-shadow:
        0 0 0 3px var(--piece-black-outer),
        0 0 0 5px var(--piece-rim),
        0 0 0 6px #111,
        /* Golden glow ring */
        0 0 0 9px var(--highlight-gold),
        0 0 18px rgba(240, 180, 41, 0.5),
        0 6px 16px rgba(0, 0, 0, 0.5),
        inset 0 2px 4px rgba(255, 255, 255, 0.15),
        inset 0 -2px 4px rgba(0, 0, 0, 0.2);
}

/* ─── Legal Move Hint Dots ─── */
.hint-dot {
    position: absolute;
    z-index: 3;
    pointer-events: none;
    border-radius: 50%;
    background: var(--hint-orange);
    opacity: 0.8;
    box-shadow: 0 0 6px rgba(230, 126, 34, 0.5);
}

/* ─── Last Move Indicator ─── */
.last-move-target::after {
    content: '';
    position: absolute;
    top: -4px;
    left: -4px;
    right: -4px;
    bottom: -4px;
    border-radius: 50%;
    border: 2.5px solid #e67e22;
    /* Earthy orange */
    box-shadow: 0 0 8px rgba(230, 126, 34, 0.6);
    /* Glow halo */
    pointer-events: none;
    z-index: 6;
    /* Above piece, below dragged */
}

/* ─── Capture Target Ring (Purple) ─── */
.capture-target::before {
    content: '';
    position: absolute;
    top: -6px;
    left: -6px;
    right: -6px;
    bottom: -6px;
    border-radius: 50%;
    border: 2.5px solid #8b5cf6;
    box-shadow:
        0 0 10px rgba(139, 92, 246, 0.55),
        0 0 20px rgba(139, 92, 246, 0.25);
    pointer-events: none;
    z-index: 7;
}

/* ─── Old Position Marker (Transient) ─── */
.old-pos-marker {
    position: absolute;
    width: 12px;
    height: 12px;
    background-color: #d35400;
    /* Dark Orange */
    /* Brown semi-transparent */
    border-radius: 50%;
    transform: translate(-50%, -50%);
    /* Centering */
    z-index: 2;
    /* Above board, below pieces */
    pointer-events: none;
    opacity: 1;
    transition: opacity 0.5s ease-out;
}

/* ═══════════════════════════════════════════════
   Responsive Rules
   ═══════════════════════════════════════════════ */

/* Mobile: tighter padding */
@media (max-width: 520px) {
    .board-shell {
        padding: 12px;
        border-width: 3px;
        border-radius: 14px;
    }

    .board-surface {
        padding: 8px;
        border-radius: 8px;
    }

    .main-container {
        padding: 8px;
    }
}

/* Large screens: cap size */
@media (min-width: 900px) {
    .board-shell {
        max-width: 560px;
    }
}