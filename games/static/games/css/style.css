@import url('https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&family=Noto+Sans+SC:wght@400;700&display=swap');

/* ─────────────── Design Tokens ─────────────── */
:root {
    /* Page */
    --bg-color: #2a120b;
    --text-color: #f0f0f0;

    /* Board */
    --board-bg: #e8c88a;
    --board-bg-light: #f0dca8;
    --board-frame: #c4a060;
    --board-frame-dark: #8b6530;
    --grid-stroke: #8b6c42;

    /* Pieces */
    --piece-red-outer: #b5372a;
    --piece-red-inner: #d04a3a;
    --piece-red-highlight: #e86050;
    --piece-black-outer: #2c2c2c;
    --piece-black-inner: #4a4a4a;
    --piece-black-highlight: #666;
    --piece-rim: #f5e6c8;
    --piece-size-ratio: 0.82;

    /* Interaction */
    --highlight-gold: #f0b429;
    --hint-orange: #e67e22;
    --accent-gold: #ffd700;
    --accent-orange: #d4862b;

}

/* ─────────────── Base ─────────────── */
body {
    font-family: 'Noto Sans SC', sans-serif;
    background:
        radial-gradient(ellipse 80% 80% at 50% 50%,
            transparent 40%,
            rgba(0, 0, 0, 0.65) 100%),
        radial-gradient(ellipse at 50% 40%,
            #4b2416 0%,
            #2a120b 70%);
    color: var(--text-color);
    margin: 0;
    min-height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
}

/* ─────────────── Layout ─────────────── */
.main-container {
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 20px;
    width: 100%;
    height: 95vh;
}

.game-area {
    display: flex;
    justify-content: center;
    align-items: center;
}

/* ─────────────── Board Wrapper (Wood Frame) ─────────────── */
.board-wrapper {
    padding: 28px;
    background:
        /* subtle wood grain */
        repeating-linear-gradient(92deg,
            rgba(0, 0, 0, 0.04) 0px,
            rgba(0, 0, 0, 0.04) 1px,
            transparent 1px,
            transparent 7px),
        repeating-linear-gradient(0deg,
            rgba(0, 0, 0, 0.02) 0px,
            rgba(0, 0, 0, 0.02) 1px,
            transparent 1px,
            transparent 14px),
        linear-gradient(160deg, #d4b896 0%, #c4a87a 40%, #b8985a 100%);
    border-radius: 16px;
    box-shadow:
        /* outer drop shadow */
        0 12px 40px rgba(0, 0, 0, 0.55),
        0 4px 12px rgba(0, 0, 0, 0.3),
        /* top highlight rim */
        inset 0 2px 0 rgba(255, 255, 255, 0.25),
        /* inner shadow for depth */
        inset 0 -2px 6px rgba(0, 0, 0, 0.15);
    position: relative;
}

/* Inner reddish-brown border line */
.board-wrapper::before {
    content: "";
    position: absolute;
    top: 12px;
    left: 12px;
    right: 12px;
    bottom: 12px;
    border: 2.5px solid var(--board-frame-dark);
    border-radius: 10px;
    pointer-events: none;
    z-index: 0;
}

/* ─────────────── Board Inner (Grid Area) ─────────────── */
.board-inner {
    position: relative;
    background:
        /* subtle wood texture */
        repeating-linear-gradient(90deg,
            rgba(0, 0, 0, 0.02) 0px,
            rgba(0, 0, 0, 0.02) 1px,
            transparent 1px,
            transparent 5px),
        repeating-linear-gradient(0deg,
            rgba(0, 0, 0, 0.012) 0px,
            rgba(0, 0, 0, 0.012) 1px,
            transparent 1px,
            transparent 9px),
        linear-gradient(180deg, var(--board-bg-light) 0%, var(--board-bg) 50%, var(--board-bg-light) 100%);

    /* Dimensions set by JS via CSS custom properties */
    overflow: visible;
    user-select: none;
    -webkit-user-select: none;
    cursor: default;
}

/* ─────────────── SVG Grid Overlay ─────────────── */
.board-svg {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 1;
}

/* ─────────────── Pieces ─────────────── */
.piece {
    position: absolute;
    z-index: 5;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    user-select: none;
    -webkit-user-select: none;

    /* Double-ring coin effect via box-shadow */
    transition:
        transform 0.18s cubic-bezier(.25, .8, .25, 1),
        box-shadow 0.18s cubic-bezier(.25, .8, .25, 1),
        filter 0.18s ease;
}

/* ─── Slide Animation ─── */
.piece--sliding {
    transition: transform 0.45s cubic-bezier(0.33, 1, 0.68, 1) !important;
    z-index: 50 !important;
    pointer-events: none !important;
}

/* ─── Captured Piece Fade-Out ─── */
.piece--captured {
    animation: fadeOutPiece 0.15s ease-out forwards;
    pointer-events: none !important;
}

@keyframes fadeOutPiece {
    to {
        opacity: 0;
        transform: scale(0.6);
    }
}

/* ─── Board Animating Lock ─── */
.board--animating {
    pointer-events: none !important;
}

/* Red pieces */
.piece-red {
    background: radial-gradient(circle at 38% 32%,
            var(--piece-red-highlight) 0%,
            var(--piece-red-inner) 40%,
            var(--piece-red-outer) 100%);
    box-shadow:
        /* outer colored ring */
        0 0 0 3px var(--piece-red-outer),
        /* cream inner ring */
        0 0 0 5px var(--piece-rim),
        /* outer border */
        0 0 0 6px #8b1a1a,
        /* drop shadow */
        0 4px 10px rgba(0, 0, 0, 0.4),
        /* inner gloss */
        inset 0 2px 4px rgba(255, 255, 255, 0.25),
        inset 0 -2px 4px rgba(0, 0, 0, 0.15);
    color: #fff;
    text-shadow:
        0 1px 2px rgba(0, 0, 0, 0.5),
        0 0 8px rgba(255, 200, 200, 0.3);
}

/* Black pieces */
.piece-black {
    background: radial-gradient(circle at 38% 32%,
            var(--piece-black-highlight) 0%,
            var(--piece-black-inner) 40%,
            var(--piece-black-outer) 100%);
    box-shadow:
        /* outer colored ring */
        0 0 0 3px var(--piece-black-outer),
        /* cream inner ring */
        0 0 0 5px var(--piece-rim),
        /* outer border */
        0 0 0 6px #111,
        /* drop shadow */
        0 4px 10px rgba(0, 0, 0, 0.5),
        /* inner gloss */
        inset 0 2px 4px rgba(255, 255, 255, 0.15),
        inset 0 -2px 4px rgba(0, 0, 0, 0.2);
    color: #e8e0d0;
    text-shadow:
        0 1px 2px rgba(0, 0, 0, 0.6),
        0 0 6px rgba(200, 200, 200, 0.2);
}

/* Piece text (Chinese character) */
.piece-text {
    font-family: 'Ma Shan Zheng', 'KaiTi', 'SimKai', 'STKaiti', serif;
    font-weight: bold;
    line-height: 1;
    pointer-events: none;
}

/* ─── Piece Hover ─── */
.piece:hover {
    transform: translateY(-2px);
    filter: brightness(1.08);
    z-index: 10;
}

.piece-red:hover {
    box-shadow:
        0 0 0 3px var(--piece-red-outer),
        0 0 0 5px var(--piece-rim),
        0 0 0 6px #8b1a1a,
        0 6px 16px rgba(0, 0, 0, 0.5),
        inset 0 2px 4px rgba(255, 255, 255, 0.25),
        inset 0 -2px 4px rgba(0, 0, 0, 0.15);
}

.piece-black:hover {
    box-shadow:
        0 0 0 3px var(--piece-black-outer),
        0 0 0 5px var(--piece-rim),
        0 0 0 6px #111,
        0 6px 16px rgba(0, 0, 0, 0.6),
        inset 0 2px 4px rgba(255, 255, 255, 0.15),
        inset 0 -2px 4px rgba(0, 0, 0, 0.2);
}

/* ─── Piece Selected ─── */
.piece.selected {
    transform: translateY(-2px);
    filter: brightness(1.1);
    z-index: 20;
}

.piece-red.selected {
    box-shadow:
        0 0 0 3px var(--piece-red-outer),
        0 0 0 5px var(--piece-rim),
        0 0 0 6px #8b1a1a,
        /* Golden glow ring */
        0 0 0 9px var(--highlight-gold),
        0 0 18px rgba(240, 180, 41, 0.5),
        0 6px 16px rgba(0, 0, 0, 0.4),
        inset 0 2px 4px rgba(255, 255, 255, 0.25),
        inset 0 -2px 4px rgba(0, 0, 0, 0.15);
}

.piece-black.selected {
    box-shadow:
        0 0 0 3px var(--piece-black-outer),
        0 0 0 5px var(--piece-rim),
        0 0 0 6px #111,
        /* Golden glow ring */
        0 0 0 9px var(--highlight-gold),
        0 0 18px rgba(240, 180, 41, 0.5),
        0 6px 16px rgba(0, 0, 0, 0.5),
        inset 0 2px 4px rgba(255, 255, 255, 0.15),
        inset 0 -2px 4px rgba(0, 0, 0, 0.2);
}

/* ─── Legal Move Hint Dots ─── */
.hint-dot {
    position: absolute;
    z-index: 3;
    pointer-events: none;
    border-radius: 50%;
    background: var(--hint-orange);
    opacity: 0.8;
    box-shadow: 0 0 6px rgba(230, 126, 34, 0.5);
}

/* ─── Last Move Indicator ─── */
.last-move-target::after {
    content: '';
    position: absolute;
    top: -4px;
    left: -4px;
    right: -4px;
    bottom: -4px;
    border-radius: 50%;
    border: 2.5px solid #e67e22;
    /* Earthy orange */
    box-shadow: 0 0 8px rgba(230, 126, 34, 0.6);
    /* Glow halo */
    pointer-events: none;
    z-index: 6;
    /* Above piece, below dragged */
}

/* ─── Capture Target Ring (Purple) ─── */
.capture-target::before {
    content: '';
    position: absolute;
    top: -6px;
    left: -6px;
    right: -6px;
    bottom: -6px;
    border-radius: 50%;
    border: 2.5px solid #8b5cf6;
    box-shadow:
        0 0 10px rgba(139, 92, 246, 0.55),
        0 0 20px rgba(139, 92, 246, 0.25);
    pointer-events: none;
    z-index: 7;
}

/* ─── King In-Check Ring (Red, Pulsing) ─── */
@keyframes checkPulse {
    0% {
        box-shadow: 0 0 0 4px rgba(220, 38, 38, 0.9), 0 0 14px rgba(220, 38, 38, 0.7);
    }

    50% {
        box-shadow: 0 0 0 6px rgba(220, 38, 38, 0.5), 0 0 26px rgba(220, 38, 38, 0.4);
    }

    100% {
        box-shadow: 0 0 0 4px rgba(220, 38, 38, 0.9), 0 0 14px rgba(220, 38, 38, 0.7);
    }
}

.piece-red.king-in-check {
    box-shadow:
        0 0 0 3px var(--piece-red-outer),
        0 0 0 5px var(--piece-rim),
        0 0 0 6px #8b1a1a,
        0 0 0 9px rgba(220, 38, 38, 0.9),
        0 0 20px rgba(220, 38, 38, 0.6),
        0 4px 10px rgba(0, 0, 0, 0.4),
        inset 0 2px 4px rgba(255, 255, 255, 0.25),
        inset 0 -2px 4px rgba(0, 0, 0, 0.15);
    animation: checkPulse 1s ease-in-out infinite;
    z-index: 20;
}

.piece-black.king-in-check {
    box-shadow:
        0 0 0 3px var(--piece-black-outer),
        0 0 0 5px var(--piece-rim),
        0 0 0 6px #111,
        0 0 0 9px rgba(220, 38, 38, 0.9),
        0 0 20px rgba(220, 38, 38, 0.6),
        0 4px 10px rgba(0, 0, 0, 0.5),
        inset 0 2px 4px rgba(255, 255, 255, 0.15),
        inset 0 -2px 4px rgba(0, 0, 0, 0.2);
    animation: checkPulse 1s ease-in-out infinite;
    z-index: 20;
}

/* ─── Old Position Marker (Transient) ─── */
.old-pos-marker {
    position: absolute;
    width: 12px;
    height: 12px;
    background-color: #d35400;
    /* Dark Orange */
    /* Brown semi-transparent */
    border-radius: 50%;
    transform: translate(-50%, -50%);
    /* Centering */
    z-index: 2;
    /* Above board, below pieces */
    pointer-events: none;
    opacity: 1;
    transition: opacity 0.5s ease-out;
}

/* ═══════════════════════════════════════════════════════════
   Game Action Panel  ── Phong cách gỗ / sơn mài / đồng cổ
   ═══════════════════════════════════════════════════════════ */

/* ── Panel (bảng gỗ) ── */
.game-actions {
    position: fixed;
    top: calc(20px + env(safe-area-inset-top));
    right: calc(18px + env(safe-area-inset-right));
    z-index: 9999;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    align-items: stretch;
    gap: 12px;

    /* Bảng treo: chiều rộng cố định, ôm đủ 3 nút */
    width: clamp(170px, 14vw, 220px);
    padding: 20px 16px;

    /* Gỗ mahogany sẫm + vân nhẹ */
    background:
        repeating-linear-gradient(178deg,
            rgba(255, 220, 160, .025) 0px,
            rgba(255, 220, 160, .025) 1px,
            transparent 1px,
            transparent 6px),
        linear-gradient(165deg, #3a1c0e 0%, #2b1308 50%, #1e0d06 100%);

    /* Viền đồng hai lớp */
    border: 2px solid #7a5a28;
    outline: 1px solid #c9944a;
    outline-offset: -5px;
    border-radius: 6px;

    /* Hiệu ứng chiều sâu như bảng đồng */
    box-shadow:
        0 0 0 1px #3a1c0e,
        0 8px 32px rgba(0, 0, 0, .7),
        0 2px 6px rgba(0, 0, 0, .5),
        inset 0 1px 0 rgba(255, 200, 100, .18),
        inset 0 -1px 0 rgba(0, 0, 0, .5);
}

/* ── Hoa văn góc giả (corner ornaments via CSS) ── */
.game-actions::before,
.game-actions::after {
    content: '◈';
    position: absolute;
    font-size: 0.65rem;
    color: #c9944a;
    opacity: 0.75;
    line-height: 1;
    pointer-events: none;
}

.game-actions::before {
    top: 5px;
    left: 6px;
}

.game-actions::after {
    bottom: 5px;
    right: 6px;
}

/* ── Nút (thẻ lệnh sơn mài) ── */
.ga-btn {
    appearance: none;
    display: block;
    position: relative;
    /* cần cho ::before (triện) */
    width: 100%;
    box-sizing: border-box;
    /* border + padding tính vào 100% */
    border: none;
    border-radius: 4px;
    padding: 13px 28px 13px 14px;

    /* Font cổ điển, hỗ trợ tiếng Việt đầy đủ */
    font-family: 'Noto Serif', 'Times New Roman', serif;
    font-size: 0.9rem;
    font-weight: 700;
    letter-spacing: .06em;
    cursor: pointer;
    text-decoration: none;
    text-align: left;
    user-select: none;

    /* Màu chữ ngà */
    color: #f5e6c8;
    text-shadow: 0 1px 3px rgba(0, 0, 0, .7);

    /* Bevel: sáng trên, tối dưới – cảm giác nổi */
    box-shadow:
        inset 0 1px 0 rgba(255, 220, 140, .25),
        inset 0 -2px 0 rgba(0, 0, 0, .4),
        2px 3px 8px rgba(0, 0, 0, .5);

    transition:
        transform .12s ease,
        box-shadow .12s ease,
        filter .12s ease;
}

/* ── Ấn triện đỏ (góc phải mỗi nút) ── */
.ga-btn::before {
    content: attr(data-seal);
    position: absolute;
    right: 5px;
    top: 50%;
    transform: translateY(-50%);
    font-family: 'Ma Shan Zheng', serif;
    font-size: 0.58rem;
    line-height: 1;
    color: #fff;
    background: #c0392b;
    border: 1px solid #8b1a1a;
    border-radius: 2px;
    padding: 1px 2px;
    opacity: 0.9;
    box-shadow: inset 0 1px 0 rgba(255, 100, 100, .3);
    pointer-events: none;
}

/* ── Hover: ánh sơn mài lướt qua ── */
.ga-btn:hover {
    transform: translateY(-1px);
    filter: brightness(1.15);
    box-shadow:
        inset 0 1px 0 rgba(255, 240, 180, .35),
        inset 0 -2px 0 rgba(0, 0, 0, .5),
        2px 5px 14px rgba(0, 0, 0, .55);
}

/* ── Active: lún xuống như ấn vào gỗ ── */
.ga-btn:active {
    transform: translateY(1px);
    filter: brightness(0.88);
    box-shadow:
        inset 0 2px 4px rgba(0, 0, 0, .5),
        inset 0 -1px 0 rgba(255, 200, 80, .1),
        1px 1px 4px rgba(0, 0, 0, .5);
}

/* ── XIN THUA (đỏ son) ── */
.ga-btn--resign {
    background: linear-gradient(160deg, #7a1c10 0%, #5a1209 100%);
    border: 1px solid #a03020;
}

.ga-btn--resign::before {
    content: attr(data-seal);
    background: #8b1a1a;
}

/* ── CẦU HÒA (vàng nghệ / đồng) ── */
.ga-btn--draw {
    background: linear-gradient(160deg, #6b4e0a 0%, #4a3407 100%);
    border: 1px solid #9a7220;
    color: #ffe9a0;
}

.ga-btn--draw::before {
    content: attr(data-seal);
    background: #7a5a10;
}

/* ── THOÁI LUI (xanh than / chàm) ── */
.ga-btn--exit {
    background: linear-gradient(160deg, #1a2e3e 0%, #0e1e2a 100%);
    border: 1px solid #2e5070;
}

.ga-btn--exit::before {
    content: attr(data-seal);
    background: #1e3e54;
}

/* ══════════ Mobile ══════════ */
@media (max-width: 520px) {
    .game-actions {
        flex-direction: row;
        justify-content: center;
        align-items: center;
        width: auto;
        min-height: unset;
        gap: 8px;
        padding: 10px 12px;
        top: auto;
        bottom: calc(14px + env(safe-area-inset-bottom));
        right: 50%;
        transform: translateX(50%);
        border-radius: 6px;
    }

    .game-actions::before {
        top: 3px;
        left: 4px;
    }

    .game-actions::after {
        bottom: 3px;
        right: 4px;
    }

    .ga-btn {
        padding: 9px 20px 9px 10px;
        font-size: 0.85rem;
    }
}

/* ═══════════════════════════════════════════════════════════════════
   Endgame Modal  ── Cuộn thư cổ trang  (古卷 phong cách kiếm hiệp)
   ═══════════════════════════════════════════════════════════════════ */

/* ── Backdrop: đêm giang hồ ── */
.egm-overlay {
    position: fixed;
    inset: 0;
    z-index: 10000;
    display: flex;
    align-items: center;
    justify-content: center;
    background:
        radial-gradient(ellipse at 50% 30%, rgba(60, 20, 0, .25) 0%, transparent 70%),
        rgba(8, 5, 3, 0.82);
    backdrop-filter: blur(4px);
    -webkit-backdrop-filter: blur(4px);
    animation: egmFadeIn .35s ease forwards;
}

.egm-overlay[hidden] {
    display: none;
}

@keyframes egmFadeIn {
    from {
        opacity: 0;
    }

    to {
        opacity: 1;
    }
}

/* ── Cuộn thư (scroll container) ── */
.egm-scroll {
    position: relative;
    width: clamp(300px, 88vw, 480px);
    animation: egmUnfurl .45s cubic-bezier(.22, .68, 0, 1.2) forwards;
    transform-origin: center top;
}

@keyframes egmUnfurl {
    from {
        transform: scaleY(0.1);
        opacity: 0;
    }

    to {
        transform: scaleY(1);
        opacity: 1;
    }
}

/* ── Trục cuộn (rod bars) — hiệu ứng trụ đồng 3D ── */
.egm-rod {
    height: 22px;
    border-radius: 11px;
    background:
        linear-gradient(180deg,
            #e8c97a 0%,
            #a07830 25%,
            #c9a048 50%,
            #7a5018 75%,
            #c0903a 100%);
    box-shadow:
        0 4px 12px rgba(0, 0, 0, .6),
        inset 0 2px 3px rgba(255, 240, 180, .4),
        inset 0 -2px 3px rgba(0, 0, 0, .4);
    position: relative;
    z-index: 2;
}

.egm-rod--top {
    border-radius: 11px 11px 0 0;
    margin-bottom: -2px;
}

.egm-rod--bottom {
    border-radius: 0 0 11px 11px;
    margin-top: -2px;
}

/* Rod end caps (circles on left/right) */
.egm-rod::before,
.egm-rod::after {
    content: '';
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: 22px;
    height: 22px;
    border-radius: 50%;
    background:
        radial-gradient(circle at 40% 35%,
            #f0d890 0%,
            #b08838 45%,
            #7a5820 100%);
    box-shadow: 0 2px 6px rgba(0, 0, 0, .5);
}

.egm-rod::before {
    left: -8px;
}

.egm-rod::after {
    right: -8px;
}

/* ── Thân cuộn (giấy gạo) ── */
.egm-body {
    position: relative;
    padding: 32px 36px 40px;
    background:
        url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='200' height='200'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.75' numOctaves='4' stitchTiles='stitch'/%3E%3CfeColorMatrix type='saturate' values='0'/%3E%3C/filter%3E%3Crect width='200' height='200' filter='url(%23n)' opacity='0.04'/%3E%3C/svg%3E"),
        linear-gradient(170deg, #f2e4c0 0%, #ead5a0 40%, #e4cc8e 100%);
    border-left: 2px solid #c9a050;
    border-right: 2px solid #c9a050;
    overflow: visible;
}

/* ── Chữ Hán lớn (mực tàu / mực đỏ) ── */
.egm-hanzi {
    font-family: 'Ma Shan Zheng', serif;
    font-size: clamp(3.5rem, 12vw, 5.5rem);
    line-height: 1;
    text-align: center;
    color: #8b1a1a;
    text-shadow:
        0 2px 0 rgba(0, 0, 0, .25),
        0 4px 16px rgba(139, 26, 26, .35);
    margin-bottom: 8px;
    letter-spacing: .04em;
}

/* Draw variant: vàng đồng */
.egm-scroll[data-type="draw"] .egm-hanzi {
    color: #6b4a08;
}

/* ── Đường kẻ trang trí (divider) ── */
.egm-divider {
    height: 1px;
    margin: 0 auto 18px;
    width: 70%;
    background: linear-gradient(90deg,
            transparent 0%,
            #a07830 20%,
            #c9a048 50%,
            #a07830 80%,
            transparent 100%);
}

/* ── Subtitle + reason (tiếng Việt) ── */
.egm-subtitle {
    font-family: 'Noto Serif', serif;
    font-size: 1.05rem;
    font-weight: 700;
    color: #3a2010;
    text-align: center;
    letter-spacing: .04em;
    margin-bottom: 6px;
}

.egm-reason {
    font-family: 'Noto Serif', serif;
    font-size: 0.82rem;
    font-style: italic;
    color: #6a4820;
    text-align: center;
    margin-bottom: 24px;
    letter-spacing: .02em;
}

/* ── Nút CTA (thẻ gỗ) ── */
.egm-actions {
    display: flex;
    gap: 14px;
    justify-content: center;
}

.egm-btn {
    display: inline-block;
    padding: 10px 22px;
    border-radius: 4px;
    font-family: 'Noto Serif', serif;
    font-size: 0.88rem;
    font-weight: 700;
    letter-spacing: .06em;
    cursor: pointer;
    text-decoration: none;
    user-select: none;
    box-sizing: border-box;
    border: none;
    transition: transform .12s ease, filter .12s ease, box-shadow .12s ease;
}

.egm-btn--retry {
    background: linear-gradient(160deg, #7a1c10 0%, #5a1209 100%);
    color: #f5e0c0;
    box-shadow:
        inset 0 1px 0 rgba(255, 180, 120, .25),
        inset 0 -2px 0 rgba(0, 0, 0, .4),
        2px 3px 8px rgba(0, 0, 0, .4);
    border: 1px solid #a03020;
}

.egm-btn--home {
    background: linear-gradient(160deg, #3a2c18 0%, #241a0c 100%);
    color: #d4b87a;
    box-shadow:
        inset 0 1px 0 rgba(255, 200, 100, .2),
        inset 0 -2px 0 rgba(0, 0, 0, .35),
        2px 3px 8px rgba(0, 0, 0, .4);
    border: 1px solid #6a4a18;
}

.egm-btn:hover {
    transform: translateY(-1px);
    filter: brightness(1.15);
}

.egm-btn:active {
    transform: translateY(1px);
    filter: brightness(0.88);
}

/* ── Triện đỏ (seal stamp) ── */
.egm-seal {
    position: absolute;
    bottom: 28px;
    right: 30px;
    width: 54px;
    height: 54px;
    display: flex;
    align-items: center;
    justify-content: center;

    font-family: 'Ma Shan Zheng', serif;
    font-size: 1.8rem;
    color: rgba(255, 255, 255, .92);

    background: #a81c1c;
    border: 2px solid #7a1010;
    border-radius: 4px;
    box-shadow:
        inset 0 1px 0 rgba(255, 100, 100, .3),
        2px 3px 8px rgba(100, 0, 0, .35);

    /* Hidden until stamped */
    opacity: 0;
    transform: scale(1.6) rotate(-8deg);
    transform-origin: center center;
    transition: none;
}

/* Draw: triện vàng đồng */
.egm-scroll[data-type="draw"] .egm-seal {
    background: #8a6010;
    border-color: #5a3a08;
}

/* Stamp animation */
.egm-seal--stamped {
    animation: egmStamp .28s cubic-bezier(.22, .68, 0, 1.3) forwards;
}

@keyframes egmStamp {
    0% {
        opacity: 0;
        transform: scale(1.8) rotate(-10deg);
    }

    65% {
        opacity: 1;
        transform: scale(0.92) rotate(2deg);
    }

    85% {
        transform: scale(1.06) rotate(-1deg);
    }

    100% {
        opacity: .9;
        transform: scale(1) rotate(0deg);
    }
}

/* ── Mobile ── */
@media (max-width: 520px) {
    .egm-body {
        padding: 22px 20px 32px;
    }

    .egm-hanzi {
        font-size: 3rem;
    }

    .egm-subtitle {
        font-size: 0.95rem;
    }

    .egm-seal {
        width: 44px;
        height: 44px;
        font-size: 1.4rem;
        bottom: 18px;
        right: 18px;
    }

    .egm-actions {
        flex-direction: column;
        align-items: center;
    }

    .egm-btn {
        width: 100%;
        text-align: center;
    }
}