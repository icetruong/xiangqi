{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Xiangqi Game</title>
    <link rel="stylesheet" href="{% static 'games/css/style.css' %}">
    <link href="https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&family=Noto+Sans+SC:wght@400;700&display=swap" rel="stylesheet">
</head>

<body>
    <div class="main-container">
        <div class="game-area">
            <div class="board-wrapper">
                <div class="board-inner" id="board"></div>
            </div>
        </div>

        <div class="sidebar">
            <div class="profile-card opponent">
                <div class="avatar">
                    <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Felix" alt="AI">
                </div>
                <div class="info">
                    <div class="name">Computer (AI)</div>
                    <div class="rank">Tập Sự <span class="icon"></span></div>
                    <div class="assets"> 54K</div>
                </div>
            </div>

            <div class="scoreboard">
                <div class="title">Bảng tỷ số</div>
                <div class="scores">
                    <span class="side-r">帥 0</span>
                    <span class="vs">VS</span>
                    <span class="side-b">將 0</span>
                </div>
                <div id="status-display" class="status-msg">
                    {{ game.status }}
                </div>
            </div>

            <div class="profile-card player">
                <div class="avatar">
                    <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Aneka" alt="Player">
                </div>
                <div class="info">
                    <div class="name">Player (You)</div>
                    <div class="rank">Nhập Môn <span class="icon"></span></div>
                    <div class="assets"> 7K</div>
                </div>
            </div>

            <div class="controls">
                <button class="btn-game" onclick="alert('Requesting Draw...')">Cầu Hòa</button>
                <button class="btn-game" onclick="alert('Resigning...')">Xin Thua</button>
                <button class="btn-game" onclick="alert('Undoing...')">Xin Đi Lại</button>
                <button class="btn-game" onclick="window.location.href='/'">Thoát</button>
            </div>

            <div class="chat-log">
                <div class="log-entry system">System: Game Started</div>
                <div id="game-status-log" class="log-entry">Turn: <span id="turn">{{ game.current_turn }}</span></div>
            </div>
        </div>
    </div>

    <script src="{% static 'games/js/game.js' %}"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var movesData = {{ legal_moves|default:"[]"|safe }};
            initGame({
                gameId: "{{ game.id }}",
                boardState: {{ game.board_state|safe }},
                currentTurn: "{{ game.current_turn }}",
                status: "{{ game.status }}",
                playerSide: "{{ game.player_side }}",
                aiSide: "{{ game.ai_side }}",
                legalMoves: movesData
            });
        });
    </script>
</body>

</html>
