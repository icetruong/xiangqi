{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Xiangqi vs AI - Start Game</title>
    <link rel="icon" type="image/svg+xml" href="{% static 'games/img/favicon.svg' %}">
    <link rel="stylesheet" href="{% static 'games/css/start-screen.css' %}">
    <link
        href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Ma+Shan+Zheng&family=Noto+Serif:wght@400;500;600;700&display=swap"
        rel="stylesheet">
</head>

<body>
    <!-- Mahogany wood background -->
    <div class="wood-background">
        <!-- Ornamental border corners -->
        <div class="border-ornament top-left"></div>
        <div class="border-ornament top-right"></div>
        <div class="border-ornament bottom-left"></div>
        <div class="border-ornament bottom-right"></div>

        <!-- Header -->
        <header class="game-header">
            <div class="logo">
                <svg class="logo-icon" width="40" height="40" viewBox="0 0 100 100" fill="none"
                    xmlns="http://www.w3.org/2000/svg">
                    <circle cx="50" cy="50" r="45" stroke="white" stroke-width="3" fill="none" />
                    <text x="50" y="65" font-family="Ma Shan Zheng" font-size="48" fill="white"
                        text-anchor="middle">å°‡</text>
                </svg>
            </div>
            <nav class="nav-links">
                <a href="#rules">Rules</a>
                <a href="#about">About</a>
            </nav>
        </header>

        <!-- Central decorative plaque frame -->
        <div class="plaque-container entrance-animate">
            <div class="plaque-frame">
                <!-- Carved decorations on frame -->
                <div class="frame-decoration top"></div>
                <div class="frame-decoration bottom"></div>
                <div class="frame-decoration left"></div>
                <div class="frame-decoration right"></div>

                <!-- Inner content area -->
                <div class="plaque-content">
                    <!-- Corner decorations -->
                    <div class="corner-decoration tl"></div>
                    <div class="corner-decoration tr"></div>
                    <div class="corner-decoration bl"></div>
                    <div class="corner-decoration br"></div>

                    <!-- Title -->
                    <h1 class="game-title">Xiangqi</h1>
                    <p class="subtitle">Choose your settings to start a new game.</p>

                    <!-- Game Setup Form -->
                    <form method="POST">
                        {% csrf_token %}

                        <!-- Difficulty Selection -->
                        <div class="form-group">
                            <label for="difficulty">Difficulty:</label>
                            <div class="select-wrapper">
                                <select name="difficulty" id="difficulty">
                                    <option value="easy">Easy (Random)</option>
                                    <option value="normal" selected>Normal (Greedy)</option>
                                    <option value="hard">Hard (Minimax Depth 4)</option>
                                </select>
                                <div class="select-arrow"></div>
                            </div>
                        </div>

                        <!-- Player Side Selection -->
                        <div class="form-group">
                            <label for="player_side">Play as:</label>
                            <div class="select-wrapper">
                                <select name="player_side" id="player_side">
                                    <option value="r" selected>Red (Goes First)</option>
                                    <option value="b">Black (Goes Second)</option>
                                </select>
                                <div class="select-arrow"></div>
                            </div>
                        </div>

                        <!-- Start Game Button -->
                        <button type="submit" class="start-button">Start Game</button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Decorative sparkle effect -->
        <div class="sparkle sparkle-1"></div>
        <div class="sparkle sparkle-2"></div>
        <div class="sparkle sparkle-3"></div>

        <!-- Floating dust particles -->
        <div class="dust dust-1"></div>
        <div class="dust dust-2"></div>
        <div class="dust dust-3"></div>
        <div class="dust dust-4"></div>
        <div class="dust dust-5"></div>
        <div class="dust dust-6"></div>
        <div class="dust dust-7"></div>
        <div class="dust dust-8"></div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const form = document.querySelector('form');
            const startBtn = document.querySelector('.start-button');
            
            if (form && startBtn) {
                form.addEventListener('submit', function (e) {
                    if (startBtn.classList.contains('loading')) {
                        e.preventDefault();
                        return;
                    }
                    startBtn.classList.add('loading');
                    // We don't set startBtn.disabled = true; here because it might prevent the form from submitting in some older browsers if triggered by enter key.
                    // Instead, we style it with pointer-events: none.
                    startBtn.innerHTML = 'Starting...';
                });
            }

            // Smooth scroll for nav
            document.querySelectorAll('.nav-links a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    // Add active class
                    document.querySelectorAll('.nav-links a').forEach(a => a.classList.remove('active'));
                    this.classList.add('active');
                    
                    const targetId = this.getAttribute('href');
                    if (targetId && targetId !== '#') {
                        const targetEl = document.querySelector(targetId);
                        if (targetEl) {
                            targetEl.scrollIntoView({
                                behavior: 'smooth'
                            });
                        }
                    }
                });
            });
        });
    </script>
</body>

</html>